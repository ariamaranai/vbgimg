chrome.runtime.onInstalled.addListener(()=>chrome.contextMenus.create({id:"",title:"View background image",contexts:["page","link","image"]})),chrome.contextMenus.onClicked.addListener(async(a,{url:u,id:i})=>u[0]!="c"&&chrome.scripting.executeScript({target:{tabId:i},world:"MAIN",func:()=>{let u=document,n,w=innerWidth,h=innerHeight,v=[],m,t=u.createTreeWalker(u.activeElement,1);while(n=t.nextNode())n.checkVisibility()&&(u=n.getBoundingClientRect()).y<h&&u.bottom>0&&u.x<w&&u.right>0&&u.width>99&&u.height>99&&(u=n.tagName=="IMG"&&((m=n.computedStyleMap()).get("position").toString()!="static"||m.get("pointer-events")=="none")&&n.src||(u=n.computedStyleMap().get("background-image").toString())[3]=="("&&u.slice(5,-2))&&!v.includes(u)&&v.push(u);return v}},v=>{a=(v=v[0].result).length;while(a)chrome.tabs.create({url:v[--a]})}))
